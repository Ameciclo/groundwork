# Kong API Gateway Helm Chart Values

replicaCount: 1

image:
  repository: kong
  pullPolicy: IfNotPresent
  tag: "3.4.0"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true

# Kong Configuration
kong:
  database: postgres

  # PostgreSQL Connection
  pg:
    host: "" # Set via environment or secret
    port: 5432
    user: kong
    database: kong
    password: "" # Set via secret
    ssl: "on"

  # Proxy Settings
  proxy:
    listen: "0.0.0.0:80, 0.0.0.0:443 ssl"
    accessLog: /dev/stdout
    errorLog: /dev/stderr

  # Admin API Settings
  admin:
    listen: "0.0.0.0:8001"
    accessLog: /dev/stdout
    errorLog: /dev/stderr

  # Kong Manager Settings
  adminGui:
    listen: "0.0.0.0:8002"
    auth: "basic-auth"
    sessionSecret: "" # Set via secret

  # Logging
  logLevel: notice
  luaSslTrustedCertificate: system

# Service Configuration
service:
  type: LoadBalancer
  annotations: {}
  ports:
    proxy:
      port: 80
      targetPort: 8000
      protocol: TCP
    proxySSL:
      port: 443
      targetPort: 8443
      protocol: TCP
    admin:
      port: 8001
      targetPort: 8001
      protocol: TCP
    adminSSL:
      port: 8444
      targetPort: 8444
      protocol: TCP
    manager:
      port: 8002
      targetPort: 8002
      protocol: TCP

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: kong.example.local
      paths:
        - path: /
          pathType: Prefix
  tls: []

httpRoute:
  enabled: false
  annotations: {}
  parentRefs:
    - name: gateway
      sectionName: http
  hostnames:
    - kong.example.local
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 250m
    memory: 256Mi

livenessProbe:
  httpGet:
    path: /status
    port: 8001
  initialDelaySeconds: 30
  periodSeconds: 10

readinessProbe:
  httpGet:
    path: /status
    port: 8001
  initialDelaySeconds: 5
  periodSeconds: 5

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80

volumes: []

volumeMounts: []

nodeSelector: {}

tolerations: []

affinity: {}
