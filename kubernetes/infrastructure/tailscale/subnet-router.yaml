---
# Tailscale Subnet Router
# This advertises K3s networks to your Tailscale network
# Allows direct access to VMs, pods, and services from your local machine
#
# After deployment, accept routes on your local machine:
#   sudo tailscale up --accept-routes
apiVersion: tailscale.com/v1alpha1
kind: Connector
metadata:
  name: k3s-subnet-router
  namespace: tailscale
  labels:
    app.kubernetes.io/name: tailscale-subnet-router
    app.kubernetes.io/component: networking
    app.kubernetes.io/managed-by: argocd
spec:
  subnetRouter:
    advertiseRoutes:
      - 10.10.0.0/16  # Azure VNet CIDR (includes K3s VM at 10.10.1.4)
      - 10.42.0.0/16  # K3s pod CIDR
      - 10.43.0.0/16  # K3s service CIDR
  hostname: k3s-subnet-router

